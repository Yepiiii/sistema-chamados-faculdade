<?xml version="1.0" encoding="utf-8" ?>
<Shell
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:views="clr-namespace:SistemaChamados.Mobile.Views"
    x:Class="SistemaChamados.Mobile.AppShell"
    FlyoutBehavior="Flyout"
    FlyoutBackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray950}}"
    Shell.TabBarBackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
    Shell.TabBarForegroundColor="{StaticResource Primary}"
    Shell.TabBarUnselectedColor="{StaticResource Gray500}"
    Shell.TabBarTitleColor="{StaticResource Primary}">

    <!-- Define o Header do Flyout (Menu Lateral) -->
    <Shell.FlyoutHeader>
        <Grid RowDefinitions="120,Auto" Padding="0" RowSpacing="0">
            <Grid.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#1B3A5F" Offset="0" />
                    <GradientStop Color="#2A5FDF" Offset="1" />
                </LinearGradientBrush>
            </Grid.Background>
            
            <!-- Logo NeuroHelp -->
            <Image Grid.Row="0"
                   Source="neurohelp_light.png"
                   WidthRequest="100"
                   HeightRequest="100"
                   Aspect="AspectFit"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"
                   Margin="0,10,0,0" />
            
            <!-- InformaÃ§Ãµes do UsuÃ¡rio - Integrado no gradiente -->
            <VerticalStackLayout Grid.Row="1" 
                                 Padding="20,16,20,20" 
                                 Spacing="8">
                <!-- Avatar com iniciais -->
                <Border WidthRequest="64"
                        HeightRequest="64"
                        StrokeShape="RoundRectangle 32"
                        BackgroundColor="White"
                        HorizontalOptions="Center"
                        StrokeThickness="3"
                        Stroke="#FFFFFF40">
                    <Label x:Name="UserInitialsLabel"
                           Text="U"
                           FontSize="26"
                           FontAttributes="Bold"
                           TextColor="{StaticResource Primary}"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />
                </Border>
                
                <!-- Nome do UsuÃ¡rio -->
                <Label x:Name="UserNameLabel"
                       Text="Carregando..."
                       FontSize="18"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center"
                       LineBreakMode="TailTruncation"
                       MaxLines="1" />
                
                <!-- Email do UsuÃ¡rio -->
                <Label x:Name="UserEmailLabel"
                       Text=""
                       FontSize="14"
                       TextColor="#FFFFFFCC"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center"
                       LineBreakMode="TailTruncation"
                       MaxLines="1" />
            </VerticalStackLayout>
        </Grid>
    </Shell.FlyoutHeader>

    <!-- Define o Footer do Flyout (Menu Lateral) -->
    <Shell.FlyoutFooter>
        <VerticalStackLayout Padding="20" Spacing="16" BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray950}}">
            
            <!-- Divisor -->
            <BoxView HeightRequest="1" 
                     BackgroundColor="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray700}}"
                     Margin="0,0,0,10" />
            
            <!-- Toggle Dark Mode -->
            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                <Label Grid.Column="0"
                       Text="ðŸŒ™"
                       FontSize="20"
                       VerticalOptions="Center" />
                <Label Grid.Column="1"
                       Text="Modo Escuro"
                       FontSize="16"
                       TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"
                       VerticalOptions="Center" />
                <Switch Grid.Column="2"
                        x:Name="ThemeSwitch"
                        Toggled="OnThemeToggled"
                        VerticalOptions="Center"
                        OnColor="{StaticResource Primary}"
                        ThumbColor="White" />
            </Grid>

            <!-- BotÃ£o de Logout -->
            <Border StrokeShape="RoundRectangle 12"
                    BackgroundColor="{StaticResource Danger}"
                    Padding="16,12"
                    StrokeThickness="0">
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnLogoutTapped" />
                </Border.GestureRecognizers>
                <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                    <Label Text="ðŸšª"
                           FontSize="18"
                           VerticalOptions="Center" />
                    <Label Text="Sair"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="White"
                           VerticalOptions="Center" />
                </HorizontalStackLayout>
            </Border>

            <!-- VersÃ£o do App -->
            <Label Text="VersÃ£o 1.0.0"
                   FontSize="12"
                   TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray400}}"
                   HorizontalOptions="Center"
                   Margin="0,10,0,0" />
        </VerticalStackLayout>
    </Shell.FlyoutFooter>

    <!-- Itens do Menu -->
    <FlyoutItem Title="Meus Chamados" Icon="ðŸ“‹">
        <ShellContent
            Title="Chamados"
            Route="chamados"
            ContentTemplate="{DataTemplate views:ChamadosListPage}" />
    </FlyoutItem>

</Shell>
